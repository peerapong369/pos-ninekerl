<!doctype html>
<html lang="th">
  <head>
    <meta charset="utf-8" />
    <title>‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #{{ order.id }}</title>
    <style>
      body {
        font-family: "Kanit", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        margin: 0;
        padding: 2rem;
        background: #f5f6fa;
        color: #1f2937;
      }
      .receipt {
        max-width: 640px;
        margin: 0 auto;
        background: #ffffff;
        padding: 2rem;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(15, 76, 129, 0.08);
      }
      h1 {
        margin: 0 0 0.5rem;
        font-size: 1.6rem;
        text-align: center;
      }
      .meta {
        text-align: center;
        margin-bottom: 1.5rem;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 1.5rem;
      }
      th,
      td {
        padding: 0.5rem;
        border-bottom: 1px solid #e5e7eb;
        text-align: left;
      }
      th {
        background: #f3f4f6;
      }
      tfoot td {
        font-weight: 600;
      }
      .totals td {
        border: none;
      }
      .totals tr:last-child td {
        padding-top: 0.75rem;
        border-top: 1px solid #d1d5db;
        font-size: 1.1rem;
      }
      .paid {
        color: #047857;
        font-weight: 600;
      }
      @media print {
        body {
          background: #ffffff;
          padding: 0;
        }
        .receipt {
          box-shadow: none;
          border-radius: 0;
        }
      }
    </style>
  </head>
  <body>
    <div class="receipt">
      <h1>‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</h1>
      <div class="meta">
        <p>‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #{{ order.id }} ‚Ä¢ ‡πÇ‡∏ï‡πä‡∏∞ {{ order.table.name }} ({{ order.table.code }})</p>
        <p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà {{ (order.paid_at or order.created_at).strftime("%Y-%m-%d %H:%M") }}</p>
      </div>

      <table>
        <thead>
          <tr>
            <th>‡πÄ‡∏°‡∏ô‡∏π</th>
            <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
            <th>‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏ó‡∏µ‡πà</th>
            <th>‡∏£‡∏ß‡∏°</th>
          </tr>
        </thead>
        <tbody>
          {% for item in order.items %}
          <tr>
            <td>{{ item.menu_item.name }}</td>
            <td>{{ item.quantity }}</td>
            <td>{{ "%.2f"|format(item.unit_price if item.unit_price is not none else item.menu_item.price) }} ‡∏ø</td>
            <td>{{ "%.2f"|format(item.subtotal) }} ‡∏ø</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <table class="totals">
        <tbody>
          <tr>
            <td>‡∏¢‡∏≠‡∏î‡∏≠‡∏≤‡∏´‡∏≤‡∏£</td>
            <td style="text-align: right">{{ "%.2f"|format(order.subtotal) }} ‡∏ø</td>
          </tr>
          <tr>
            <td>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</td>
            <td style="text-align: right">-{{ "%.2f"|format(order.discount_amount) }} ‡∏ø</td>
          </tr>
          <tr>
            <td>‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</td>
            <td style="text-align: right">{{ "%.2f"|format(order.service_charge) }} ‡∏ø</td>
          </tr>
          <tr>
            <td>‡∏†‡∏≤‡∏©‡∏µ ({{ "%.2f"|format(order.tax_rate) }}%)</td>
            <td style="text-align: right">{{ "%.2f"|format(order.tax_amount) }} ‡∏ø</td>
          </tr>
          <tr>
            <td>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</td>
            <td style="text-align: right"><strong>{{ "%.2f"|format(order.grand_total) }} ‡∏ø</strong></td>
          </tr>
          <tr>
            <td>‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß</td>
            <td style="text-align: right">{{ "%.2f"|format(order.amount_paid) }} ‡∏ø</td>
          </tr>
          <tr>
            <td>‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</td>
            <td style="text-align: right">
              {% if order.balance_due > 0 %}
              {{ "%.2f"|format(order.balance_due) }} ‡∏ø
              {% else %}
              <span class="paid">‡∏ä‡∏≥‡∏£‡∏∞‡∏Ñ‡∏£‡∏ö</span>
              {% endif %}
            </td>
          </tr>
        </tbody>
      </table>

      {% if order.payments %}
      <p><strong>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞:</strong></p>
      <ul>
        {% for payment in order.payments %}
        <li>
          {{ payment.paid_at.strftime("%Y-%m-%d %H:%M") }} ‚Ä¢ {{ payment_labels.get(payment.method, payment.method) }} ‚Ä¢
          {{ "%.2f"|format(payment.amount) }} ‡∏ø
          {% if payment.reference %} ({{ payment.reference }}){% endif %}
        </li>
        {% endfor %}
      </ul>
      {% endif %}

      <p style="text-align: center; margin-top: 2rem">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô‡∏£‡πâ‡∏≤‡∏ô NineKerl üçú</p>
    </div>
  </body>
</html>
